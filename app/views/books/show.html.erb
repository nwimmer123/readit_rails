<%= javascript_tag do %>

$(document).ready(function() {

  console.log("In JS Script");
  var randomNum = Math.floor((Math.random()*30)+1);
  var backgroundUrl = '/images/images' + randomNum + '.jpg';
  console.log(backgroundUrl);
  $('.showpage').css("background", "url(" + backgroundUrl + ") no-repeat center center");

  $(".spoiler").hide();

  $("#show_spoilers").on("click", function() {
    $(".spoiler").show();
  });


});

<% end %>

<div class="showpage">

  <div class="container showTitle">
    <h1 class="text-center"><%= @book.title %><h1>
    <h3 class="text-center"><%= @book.author %><h3>
  </div>

  <ul class="container singleBook">
    <img src=<%= @book.image %> alt="Book Jacket" id="showpageImages">
    <p><b>Contributor: </b><%= @book.user.name %></p>
    <p><b>Genre: </b><%= @book.genre %></p>
    <p><b>Publication Date: </b><%= @book.publication_date %></p>
    <p><b>Publisher: </b><%= @book.publisher %></p>
    <p><b>Synopsis: </b><%= @book.synopsis %></p>
  </ul>

  <div class="container addReview">
    <h2>Reviews and Discussion</h2>

    <%= render 'form' %>

  </div>

  <div class="container">
    <button class="btn btn-danger" id="show_spoilers">Show Spoilers</button>
  </div>

  <%= reviews_tree_for @reviews %>

  <div class="container">
    <% @reviews.each do |review| %>
      <% if review.book_id.to_s == params[:id].to_s %>
        <% review_class = review.spoiler == "1" ? ' spoiler' : ' spoiler-free' %>

          


        
<%
=begin %> WORKING NON NESTED REVIEW CODE

        <div class="review <%= review_class%>">
          <strong><%= review.user.name %></strong>
            <% if review.spoiler == "1" %>
              <span class="center-text pull-right">SPOILER</span>
            <% end %>
          <p><%= review.body %></p>

<%
=end %>
    
        </div>
      <% end %>
    <% end %>
  </div>

</div>
